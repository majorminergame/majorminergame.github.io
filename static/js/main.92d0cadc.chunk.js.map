{"version":3,"sources":["base.js","landing/LoginForm.js","info/PrivacyPage.js","landing/RegisterForm.js","landing/LandingPage.js","root/Footer.js","info/FaqPage.js","info/ContactPage.js","root/AccountButton.js","root/Header.js","main/AudioVisualizer.js","main/AudioAnalyser.js","main/GameRuleDialog.js","main/NewGamePage.js","main/AudioCard.js","main/SummaryPage.js","info/LeadersPage.js","search/SearchPage.js","search/SearchResult.js","App.js","serviceWorker.js","index.js"],"names":["app","firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","LoginForm","Component","constructor","props","super","handleClickOpen","this","_isMounted","setState","open","handleClose","handleKeyPress","event","key","document","getElementById","click","handleSubmit","a","preventDefault","auth","signInWithEmailAndPassword","value","user","console","log","history","push","alert","state","componentDidMount","componentWillUnmount","render","item","color","variant","onClick","onClose","maxWidth","fullWidth","container","direction","spacing","margin","id","onKeyPress","type","withRouter","PrivacyPage","className","target","href","rel","RegisterForm","handleClickOpenForm","openForm","handleCloseForm","agreePolicy","handleAgreePolicy","checked","policyError","handleClickOpenPolicy","openPolicy","handleClosePolicy","validateForm","username","email","password","password2","test","emailError","length","passwordError","password2Error","usernameError","db","firestore","createUserWithEmailAndPassword","collection","doc","currentUser","uid","set","score","justify","alignItems","error","control","onChange","label","component","style","fontSize","LandingPage","Summary","currentId","userId","userRef","audioRef","tempTag","tempTag1","orderBy","limit","get","clipHistorySnapshot","clipHistory","docs","clip","data","audio","tagsSnapshot","otherTagSnapshot","Promise","all","audio1","tagsSnapshot1","otherTagSnapshot1","title","Title","url","Url","tags","TAG","join","tag","includes","other","where","scoredClipHistorySnapshot","scoredClipHistory","audioSnapshot","scoreTagsSnapshot","otherScoreTagSnapshot","scoreTagsSnapshot1","otherScoreTagSnapshot1","pathname","lg","md","sm","authenticated","Link","to","Footer","FaqPage","data-testid","paddingTop","ContactPage","AccountButton","handleToggle","buttonRef","node","anchorEl","aria-owns","undefined","aria-haspopup","placement","transition","disablePortal","TransitionProps","onClickAway","logout","Header","userDocListener","signOut","then","toggleAuth","catch","err","position","AudioVisualiser","canvas","React","createRef","componentDidUpdate","draw","audioData","current","height","width","context","getContext","x","sliceWidth","lineWidth","strokeStyle","clearRect","beginPath","moveTo","y","lineTo","stroke","ref","AudioAnalyser","setupAudioContext","audioContext","window","AudioContext","webkitAudioContext","gainNode","createGain","gain","connect","destination","audioSource","createMediaElementSource","analyser","createAnalyser","dataArray","Uint8Array","frequencyBinCount","rafId","requestAnimationFrame","tick","onended","play","toggleAudio","firstPlay","clipId","d","Date","now","count","staticFirebase","FieldValue","increment","updated","serverTimestamp","millis","arrayUnion","merge","pause","playAuto","bind","Audio","crossOrigin","screen","getByteTimeDomainData","resume","cancelAnimationFrame","disconnect","disableRipple","disableTouchRipple","AudioVisualizer","GameRuleDialog","toggleExample","showExample","INITIAL_STATE","currentTags","displayTag","loading","GamePage","firstUserId","loadUrl","loadFiles","xmlhttp","XMLHttpRequest","audiosDataRef","randomRef","onreadystatechange","status","readyState","responseText","myJSON","JSON","parse","items","i","name","metadata","firebaseStorageDownloadTokens","send","existingTags","randomizeId","loadExistingTag","forEach","compareTime","timeStamp","month","thatTime","toMillis","todayDate","getDate","thisMonth","getMonth","year","getFullYear","parseStringToday","today","oneDayRange","userHasSeen","Set","rand","Math","random","currentUserSeenSnapshot","userSeen","add","pnew","findMin","size","pick_pioneer","pick_settler","noSeenSnapshot","floor","oneHour","oneHourNoSeenSnapshot","has","num1","num2","getNextClip","newTags","toLowerCase","replace","split","tempCurrentTags","audioTagRef","audioUsersRef","Object","keys","loadTagsToDb","prevState","getUserId","firstUser","addUser","History","firstUserRef","refreshTotalScore","update","isFrist","userClipHistoryRef","exists","updateHistory","createHistory","oneDayRangeMillis","scoreRecordRef","scoreRef","createdAt","lastUpdatedAt","textInput","prevProps","focus","thickness","map","autoFocus","inputRef","endAdornment","AudioCard","togglePlay","toggleSeeOtherTags","seeOthers","SummaryAudioCard","SearchResultAudioCard","fromSummary","SummaryPage","LeadersPage","handleChange","monthArray","firstOfWeekRange","first","getDay","getTotal","totalLeader","userSnapshot","sort","b","splice","getToday","todayLeader","todayRange","todayUserSnapshot","getWeek","weekLeader","thisWeekRange","weekUserSnapshot","totalScore","scoreSnapshot","getTabContent","content","align","centered","SearchPage","getTagList","tagList","myPromise","p","searchItem","handleListClick","getList","topTags","button","primary","xs","SearchResult","MyTag","tagOrderArray","clipNumber","getCurrentTarget","location","index","lastIndexOf","substring","tagPromise","tagOrder","MyTagMap","tagObject","theme","createMuiTheme","palette","main","secondary","typography","useNextVariants","PrivateRoute","rest","Route","Redirect","App","listener","onAuthStateChanged","Switch","exact","path","NewGamePage","Boolean","hostname","match","ReactDOM","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.92d0cadc.chunk.js","sourcesContent":["import firebase from 'firebase/app';\n// import 'firebase/app';\n// import 'firebase/auth';\n// import 'firebase/firestore';\n\n\nconst app = firebase.initializeApp({\n  apiKey: process.env.REACT_APP_FIREBASE_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_DOMAIN,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_SENDER_ID\n});\n\nexport default app;","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport app from \"../base\";\nimport {\n  Grid,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  FormControl,\n  Input,\n  InputLabel\n} from \"@material-ui/core\";\n\nclass LoginForm extends Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n    this.state = {\n      open: false\n    };\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n  }\n\n  handleClickOpen = () => {\n    if (this._isMounted) {\n      this.setState({ open: true });\n    }\n  };\n\n  handleClose = () => {\n    if (this._isMounted) {\n      this.setState({ open: false });\n    }\n  };\n\n  handleKeyPress = event => {\n    if (event.key === 'Enter') {\n      document.getElementById(\"submitButton\").click();\n    }\n  }\n\n  handleSubmit = async event => {\n    event.preventDefault();\n    try {\n      const user = await app\n        .auth()\n        .signInWithEmailAndPassword(document.getElementById(\"email\").value, document.getElementById(\"password\").value);\n        console.log(user);\n        if (user) {\n          this.handleClose();\n          this.props.history.push(\"/main/clip\");\n        }\n    } catch (err) {\n      alert(err);\n    }\n  }\n  \n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  render() {\n    return (\n      <Grid item>\n        <Button color=\"default\" variant=\"outlined\" onClick={this.handleClickOpen}>Login</Button>\n        <Dialog\n          open={this.state.open}\n          onClose={this.handleClose}\n          maxWidth=\"xs\"\n          fullWidth\n        >\n          <DialogTitle>Login</DialogTitle>\n          <DialogContent>\n            <Grid container direction=\"column\" spacing={16}>\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Email</InputLabel>\n                  <Input id=\"email\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n              </Grid>\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Password</InputLabel>\n                  <Input id=\"password\" type=\"password\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n              </Grid>\n            </Grid>\n          </DialogContent>\n          <DialogActions>\n            <Button id=\"submitButton\" onClick={this.handleSubmit}>Submit</Button>\n          </DialogActions>\n        </Dialog>\n      </Grid>\n    );\n  }\n}\n\nexport default withRouter(LoginForm);","import React, { Component } from \"react\";\n\nclass PrivacyPage extends Component {\n  render() {\n    return (\n      <div className=\"privacy-container\">\n        <h1 className=\"page-title\">Privacy and Participation</h1>\n        <p>\n          You are being asked to participate in this research study because you\n          are an adult at least 18 years of age. The purpose of this research\n          study is to collect descriptions of sounds from people, so that we can\n          train computer models to automatically describe new sounds. If you\n          agree to participate, we will ask you to listen to sounds and provide\n          free-form textual descriptions of them. Listening to and labeling each\n          sound will take less than a minute, and you can do as many or as few\n          as you would like, whenever you would like. Research-related risks to\n          you are minimal, but include fatigue and exposure to volume variations\n          between sounds. We will only record your descriptions, we will not\n          record any personally identifiable information from you and will only\n          identify you within our system by a username of your choosing. The\n          descriptions that we collect will be stored on our servers at Brooklyn\n          College and made available to other researchers for the same purpose.\n          Your participation in this research is voluntary. If you have any\n          questions, you can contact Michael Mandel at{\" \"}\n          <a\n            target=\"_blank\"\n            href=\"mailto:mim@sci.brooklyn.cuny.edu\"\n            rel=\"noopener noreferrer\"\n          >\n            mim@sci.brooklyn.cuny.edu\n          </a>\n          &nbsp;or 718.951.5000 x2053. If you have any questions about your rights as\n          a research participant or if you would like to talk to someone other\n          than the researchers, you can contact CUNY Research Compliance\n          Administrator at 646-664-8918 or{\" \"}\n          <a\n            target=\"_blank\"\n            href=\"mailto:HRPP@cuny.edu\"\n            rel=\"noopener noreferrer\"\n          >\n            HRPP@cuny.edu\n          </a>\n          .\n        </p>\n      </div>\n    );\n  }\n}\n\nexport default PrivacyPage;\n","import React, { Component } from \"react\";\nimport app from \"../base\";\nimport {\n  Grid,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Checkbox,\n  Button,\n  FormControl,\n  FormControlLabel,\n  FormHelperText,\n  Input,\n  InputLabel,\n  Link\n} from \"@material-ui/core\";\nimport PrivacyPage from \"../info/PrivacyPage\";\nimport { withRouter } from \"react-router-dom\";\n\nclass RegisterForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      openForm: false,\n      agreePolicy: false,\n      openPolicy: false,\n      policyError: false,\n      emailError: false,\n      passwordError: false,\n      password2Error: false,\n      usernameError:false\n    };\n  }\n\n  handleClickOpenForm = () => {\n    this.setState({ openForm: true });\n  };\n\n  handleCloseForm = () => {\n    this.setState({ openForm: false, agreePolicy: false });\n  };\n\n  handleAgreePolicy = event => {\n    this.setState({ agreePolicy: event.target.checked });\n    if (event.target.checked) {\n      this.setState({ policyError: false });\n    }\n  }\n\n  handleClickOpenPolicy = () => {\n    this.setState({ openPolicy: true });\n  };\n\n  handleClosePolicy = () => {\n    this.setState({ openPolicy: false });\n  };\n\n  handleKeyPress = event => {\n    if (event.key === 'Enter') {\n      document.getElementById(\"submitButton\").click();\n    }\n  }\n\n  validateForm = () => {\n    const username = document.getElementById(\"username\").value;\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    const password2 = document.getElementById(\"password2\").value;\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    \n    if (re.test(email)) {\n      this.setState({ emailError: false });\n    } else {\n      this.setState({ emailError: true });\n    }\n\n    if (password.length < 6) {\n      this.setState({ passwordError: true });\n    } else {\n      this.setState({ passwordError: false });\n    }\n\n    if (password !== password2) {\n      this.setState({ password2Error: true });\n    } else {\n      this.setState({ password2Error: false });\n    }\n\n    if(username === ''){\n      this.setState({usernameError: true});\n    }else{\n      this.setState({usernameError: false});\n    }\n    \n    if (!this.state.agreePolicy) {\n      this.setState({ policyError: true });\n    }\n\n    return ({ email, password, username });\n  }\n\n  handleSubmit = async event => {\n    const { history } = this.props;\n    event.preventDefault();\n    // validation part\n    const { email, password, username } = await this.validateForm();\n    const db = app.firestore();\n    if (!this.state.policyError && !this.state.emailError && !this.state.passwordError && !this.state.password2Error && !this.state.usernameError) {\n      // create User in app\n      try {\n        const user = await app\n          .auth()\n          .createUserWithEmailAndPassword(email, password);\n        console.log(user);\n        if (user) {\n          // to create a new user document\n          db.collection('users').doc(app.auth().currentUser.uid).set({\n            username: username,\n            score: 0\n          });\n          this.handleCloseForm();\n          history.push(\"/main/clip\");\n        }\n      } catch(err) {\n        alert(err);\n      }\n    }\n  }\n\n  render() {\n    return (\n      <Grid item>\n        <Button\n          color=\"default\"\n          variant=\"outlined\"\n          onClick={this.handleClickOpenForm}\n        >Register</Button>\n        <Dialog\n          open={this.state.openForm}\n          onClose={this.handleCloseForm}\n          maxWidth=\"xs\"\n          fullWidth\n        >\n          <DialogTitle>Register</DialogTitle>\n          <DialogContent>\n            <Grid container direction=\"column\" justify=\"space-evenly\" alignItems=\"stretch\">\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Username</InputLabel>\n                  <Input id=\"username\" type=\"text\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n                 {this.state.usernameError ? (\n                  <FormHelperText error={true}>Must Enter Your Username.</FormHelperText>\n                ) : \"\"}\n              </Grid>\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Email</InputLabel>\n                  <Input id=\"email\" type=\"email\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n                {this.state.emailError ? (\n                  <FormHelperText error={true}>Invalid email.</FormHelperText>\n                ) : \"\"}\n              </Grid>\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Password</InputLabel>\n                  <Input id=\"password\" type=\"password\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n                {this.state.passwordError ? (\n                  <FormHelperText error={true}>Password should be more than 6 characters.</FormHelperText>\n                ) : \"\"}\n              </Grid>\n              <Grid item>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Reenter password</InputLabel>\n                  <Input id=\"password2\" type=\"password\" onKeyPress={this.handleKeyPress} />\n                </FormControl>\n                {this.state.password2Error ? (\n                  <FormHelperText error={true}>Passwords didn't match.</FormHelperText>\n                ) : \"\"}\n              </Grid>\n              <Grid item>\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      checked={this.state.agreePolicy}\n                      onChange={this.handleAgreePolicy}\n                    />\n                  }\n                  label={\n                    <p>I accept the&nbsp;\n                      <Link\n                        component=\"button\"\n                        onClick={this.handleClickOpenPolicy}\n                        style={{ fontSize: \"1em\" }}\n                      >\n                        Privacy Policy\n                      </Link>\n                    </p>\n                  }\n                />\n                {this.state.policyError ? (\n                  <FormHelperText error={true}>You have to accept the privacy policy.</FormHelperText>\n                ) : \"\"}\n                <Dialog\n                  open={this.state.openPolicy}\n                  onClose={this.handleClosePolicy}\n                  maxWidth={false}\n                >\n                  <DialogContent className=\"privacy-in-dialog\">\n                    <PrivacyPage />\n                  </DialogContent>\n                </Dialog>\n              </Grid>\n            </Grid>\n          </DialogContent>\n          <DialogActions>\n            <Button id=\"submitButton\" onClick={this.handleSubmit}>Submit</Button>\n          </DialogActions>\n        </Dialog>\n      </Grid>\n    );\n  }\n}\n\nexport default withRouter(RegisterForm);","import React, { Component } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { Link } from \"react-router-dom\";\nimport LoginForm from \"./LoginForm\";\nimport RegisterForm from \"./RegisterForm\";\nimport firebase from \"../base\";\n\nclass LandingPage extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      clipHistory: {},\n      scoredClipHistory: {}\n    }\n  };\n  // componentDidMount (){\n    \n  // }\n  Summary = async () => {\n    this.user = firebase.auth().currentUser;\n    this.db = firebase.firestore();\n    this.currentId = this.user.uid;\n    this.userId = this.user.uid;\n    this.userRef = this.db.collection('users').doc(this.currentId);\n    this.audioRef = this.db.collection('audios');\n    var tempTag = [];\n    var tempTag1 = [];\n    const clipHistorySnapshot = await this.userRef.collection('clipHistory').orderBy('lastUpdatedAt').limit(10).get();\n    const clipHistory = {};\n    \n  for (const clip of clipHistorySnapshot.docs){\n      clipHistory[clip.id] = { score: clip.data().score };\n      var audio = this.db.collection('audios').doc(clip.id).get();\n      tempTag = [];\n      tempTag1 = [];\n      var tagsSnapshot = this.db.collection('audios').doc(clip.id).collection('users').doc(this.userId).get();\n      var otherTagSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').get();\n      \n      const [audio1,tagsSnapshot1,otherTagSnapshot1] = await Promise.all([audio,tagsSnapshot,otherTagSnapshot]);\n      clipHistory[clip.id].title = audio1.data().Title;\n      clipHistory[clip.id].url = audio1.data().Url;\n      clipHistory[clip.id].id = clip.id;\n\n      tempTag = tagsSnapshot1.data().tags;\n      clipHistory[clip.id].TAG = tempTag.join(\", \");\n\n      for(const tag of otherTagSnapshot1.docs){\n        if(!tempTag.includes(tag.id)){\n          tempTag1.push(tag.id);\n        }\n      }\n        clipHistory[clip.id].other = tempTag1.join(\", \");\n      this.setState({ clipHistory });\n  }\n\n    const scoredClipHistorySnapshot = await this.userRef.collection('clipHistory').where(\"score\", \">\", 0).orderBy(\"score\").limit(10).get();\n    const scoredClipHistory = {};\n    for(const clip of scoredClipHistorySnapshot.docs){\n      scoredClipHistory[clip.id] = { score: clip.data().score };\n      var audioSnapshot = this.db.collection('audios').doc(clip.id).get();\n      var scoreTagsSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').where(\"userId\", 'array-contains',this.userId).get();\n      var otherScoreTagSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').get();\n    \n    const [audio1,scoreTagsSnapshot1,otherScoreTagSnapshot1] = await Promise.all([audioSnapshot,scoreTagsSnapshot,otherScoreTagSnapshot]);\n      scoredClipHistory[clip.id].title = audio1.data().Title;\n      scoredClipHistory[clip.id].url = audio1.data().Url;\n      scoredClipHistory[clip.id].id = clip.id;\n      tempTag = [];\n      tempTag1 = [];\n\n      for(const tag of scoreTagsSnapshot1.docs){\n        tempTag.push(tag.id);\n      }\n      scoredClipHistory[clip.id].TAG = tempTag.join(\", \");\n\n      for(const tag of otherScoreTagSnapshot1.docs){\n        if(!tempTag.includes(tag.id)){\n          tempTag1.push(tag.id);\n        }\n      }\n      scoredClipHistory[clip.id].other = tempTag1.join(\", \");\n      this.setState({ scoredClipHistory });\n    }\n    console.log(this.state.scoredClipHistory)\n    console.log(this.state.clipHistory)\n    \n    this.props.history.push({\n      pathname: '/main',\n      state: {\n       clipHistory: this.state.clipHistory,\n       scoredClipHistory: this.state.scoredClipHistory\n      }\n    })\n  }\n  render() {\n    return (\n      <Grid\n        container\n        className=\"home-container\"\n        direction=\"column\"\n        alignItems=\"center\"\n      >\n        <Grid item>\n          <h1 style={{ fontSize: \"2.5em\" }}>Major Miner</h1>\n          <p style={{ fontSize: \"1.25em\" }}>A Sound Labeling Game</p>\n        </Grid>\n        <Grid item lg={6} md={8} sm={10}>\n          <p>\n            The goal of the game, besides just listening to interesting\n            soundscapes, is to label them with <b>original</b>, yet <b>relevant</b> words and\n            phrases that other players <b>agree with</b>. We're going to use your\n            descriptions to teach our computers to recognize these same sounds\n            in over 100,000 hours of recordings so that we can better understand\n            the behavior of animals and how it is affected by human activity.\n          </p>\n        </Grid>\n        {this.props.authenticated ? (\n          <Grid item sm={8} md={8} lg={8} container justify=\"center\" spacing={16}>\n            <Grid item onClick={this.Summary}>\n              Summary\n            </Grid>\n            <Grid item>\n              <Link to=\"/main/clip\">Play game!</Link>\n            </Grid>\n          </Grid>\n        ) : (\n          <Grid item sm={8} md={8} lg={8} container justify=\"center\" spacing={16}>     \n            <LoginForm />\n            <RegisterForm />\n          </Grid>\n        )}\n      </Grid>\n    );\n  }\n}\n\nexport default LandingPage;","import React, { Component } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { Link } from \"react-router-dom\";\n\nclass Footer extends Component {\n  render() {\n    return (\n      <Grid container className=\"footer\" justify=\"center\" spacing={8}>\n        <Grid item>\n          <Link to=\"/\">Home</Link>\n        </Grid>\n        <Grid item>\n          <Link to=\"/info/faq\">FAQ</Link>\n        </Grid>\n        <Grid item>\n          <Link to=\"/info/contact\">Contact us</Link>\n        </Grid>\n        <Grid item>\n          <Link to=\"/info/privacy\">Privacy policy</Link>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default Footer;\n","import React, { Component } from \"react\";\nimport { Grid, Card, CardContent } from \"@material-ui/core\";\n\nclass FaqPage extends Component {\n  render() {\n    return (\n      <Grid \n      data-testid=\"fagPage\"\n      container direction=\"column\">\n        <Grid item>\n          <h1 className=\"page-title\" style={{ paddingTop: \"1em\" }}>Frequently asked questions</h1>\n        </Grid>\n        <Grid\n          item\n          container\n          className=\"faq-container\"\n          direction=\"column\"\n          spacing={16}\n          alignItems=\"stretch\"\n        >\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>How should I describe clips?</h3>\n                <p>\n                  There are many ways you could describe a clip, we want you to\n                  make up your own, but if you're stuck, here are some examples.\n                  You could use the names of the things you hear (as\n                  specifically or generally as you like), general descriptions\n                  of the scene, the time of day or year you think it is, even\n                  how it makes you feel. Here are some examples, by no means\n                  exhaustive, of each of those categories:\n                </p>\n                <ul>\n                  <li>\n                    Animals  bird, songbird, sparrow, white-crowned sparrow,\n                    gambel's white crowned sparrow\n                  </li>\n                  <li>\n                    Human-generated sounds  airplane, helicopter, drilling,\n                    engine, rumbling\n                  </li>\n                  <li>\n                    Weather  wind, rain, thunder, gale, drizzle, dripping,\n                    stream, river\n                  </li>\n                  <li>Scenes  quiet night, dawn chorus</li>\n                  <li>\n                    Time  summer, winter, june, august afternoon, night, dawn\n                  </li>\n                  <li>Feelings  calm, busy, soothing, loud, cacophonous</li>\n                </ul>\n              </CardContent>\n            </Card>\n          </Grid>\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>Can I input more than one tag at a time?</h3>\n                <p>Yes, separate your tags with commas.</p>\n              </CardContent>\n            </Card>\n          </Grid>\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>What's a good strategy to use?</h3>\n                <p>\n                  If you want to earn some points quickly, you can try to guess\n                  the obvious labels for a clip. Someone else has probably\n                  already used them, so you might get 1 point or you might get 0\n                  points, depending on how many people have used them already.\n                  If you're feeling more patient, you can tag a clip with a\n                  slightly less obvious, more creative, or more subjective\n                  label, so you'll have a better chance of being the first\n                  person to use that tag. You won't get any points initially,\n                  but when someone else comes along and uses it too, you'll get\n                  2 points. You'd be surprised how frequently other people are\n                  thinking the same thing as you. Just remember that every time\n                  one user scores a single point, another user has just scored\n                  two.\n                </p>\n              </CardContent>\n            </Card>\n          </Grid>\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>\n                  Does it matter how I capitalize, punctuate, or spell words?\n                </h3>\n                <p>\n                  Not much. Our matching algorithm is clever enough to handle\n                  these and give you credit for matching other players' tags\n                  that differ in capitalization, punctuation, and spelling\n                </p>\n              </CardContent>\n            </Card>\n          </Grid>\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>I found a clip that won't play</h3>\n                <p>\n                  If you press the play button and it jumps right back to \"play\"\n                  mode without playing anything, you've probably found a broken\n                  clip. If you could tag it \"won't play\", we'll remove it from\n                  the game as quickly as we can.\n                </p>\n              </CardContent>\n            </Card>\n          </Grid>\n          <Grid item>\n            <Card>\n              <CardContent>\n                <h3>\n                  I tried using my browser's back button to go back to my last\n                  clip, but it seems to be acting funny\n                </h3>\n                <p>\n                  That's intentional. Once you've gone to the summary page, you\n                  can go back and listen to your last clip (which you can do\n                  that from the summary page anyway), but you can't tag it any\n                  more. Any tags you try to submit will be ignored. Only go to\n                  the summary page once you're finished tagging your current\n                  clip. This is to prevent people from looking at the artist\n                  name or other metadata when they're tagging a clip.\n                </p>\n              </CardContent>\n            </Card>\n          </Grid>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default FaqPage;\n","import React, { Component } from \"react\";\n\nclass ContactPage extends Component {\n  render() {\n    return (\n      <div className=\"contact-container\">\n        <h1 className=\"page-title\">Contact us</h1>\n        <p>\n          Please contact us with any questions, comments, congratulations, or\n          concerns.\n        </p>\n        <p>The easiest way is to leave a comment on our blog,</p>\n        <a href=\"http://blog.majorminer.org\">blog.majorminer.org</a>\n        <p>but email is also welcome:</p>\n        <a\n          target=\"_blank\"\n          href=\"mailto:info@majorminer.org\"\n          rel=\"noopener noreferrer\"\n        >\n          info@majorminer.org\n        </a>\n      </div>\n    );\n  }\n}\n\nexport default ContactPage;\n","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport {\n  IconButton,\n  Popper,\n  Grow,\n  Paper,\n  ClickAwayListener,\n  MenuList,\n  MenuItem\n} from \"@material-ui/core\";\nimport AccountCircle from '@material-ui/icons/AccountCircle';\n\nclass AccountButton extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false\n    };\n  }\n\n  handleToggle = () => {\n    this.setState(state => ({ open: !state.open }));\n  }\n\n  handleClose = event => {\n    // if (this.anchorEl.contains(event.target)) {\n    //   return;\n    // }\n\n    this.setState({ open: false });\n  }\n\n  render() {\n    const { open } = this.state;\n    return (\n      <div>\n        <IconButton\n          buttonRef={node => {\n            this.anchorEl = node;\n          }}\n          aria-owns={open ? \"account-menu\" : undefined}\n          aria-haspopup=\"true\"\n          onClick={this.handleToggle}\n          color=\"inherit\"\n        >\n          <AccountCircle />\n        </IconButton>\n        <Popper\n          open={open}\n          anchorEl={this.anchorEl}\n          placement=\"bottom-end\"\n          transition\n          disablePortal\n        >\n          {({ TransitionProps }) => (\n            <Grow {...TransitionProps}>\n              <Paper>\n                <ClickAwayListener onClickAway={this.handleClose}>\n                  <MenuList>\n                    <MenuItem onClick={this.handleClose}>\n                      <Link to=\"/main\">Summary</Link>\n                    </MenuItem>\n                    <MenuItem onClick={this.handleClose}>\n                      Change password\n                    </MenuItem>\n                    <MenuItem onClick={() => {\n                      this.props.logout();\n                      this.handleClose();\n                    }}>Logout</MenuItem>\n                  </MenuList>\n                </ClickAwayListener>\n              </Paper>\n            </Grow>\n          )}\n        </Popper>\n      </div>\n    );\n  }\n}\n\nexport default AccountButton;\n","import React, { Component } from \"react\";\nimport {\n  AppBar,\n  Toolbar,\n  ButtonBase\n} from \"@material-ui/core\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport firebase from \"../base\";\nimport LoginForm from \"../landing/LoginForm\";\nimport AccountButton from \"./AccountButton\";\n\nclass Header extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      score: null\n    };\n  }\n\n  componentDidMount() {\n    this.db = firebase.firestore();\n    this.user = firebase.auth().currentUser;\n   // this.userRef = this.db.collection('users').doc(this.user.uid);\n    if (this.user) {\n      //this.userRef = \n      this.db.collection('users').doc(this.user.uid).get().then(user => {\n          this.setState({ score: user.data().score });\n      });\n    }\n  }\n\n  logout = () => {\n    if (this.userDocListener) {\n      this.userDocListener();\n    }\n    firebase.auth().signOut().then(() => {\n      this.props.toggleAuth(false);\n    }).catch(err => {\n      console.log(err);\n    })\n    //this.props.history.push('/Major--Miner');\n    this.props.history.push('/');\n\n    this.setState({ score: 0});\n  }\n\n  componentWillUnmount() {\n    if (this.userDocListener) {\n      this.userDocListener();\n    }\n  }\n\n  render() {\n  \n    return (\n      <AppBar position=\"sticky\">\n        <Toolbar>\n          <div className=\"nav-container\">\n            <ButtonBase component={Link} to=\"/\" className=\"nav-item\"><b style={{ \"fontSize\": \"1.5em\" }}>Major Miner</b></ButtonBase>\n            {/* <Link to=\"/\" className=\"nav-item\"><h2>Major Miner</h2></Link> */}\n            {this.props.authenticated ? (\n              <ButtonBase component={Link} to=\"/main/clip\" className=\"nav-item\">Game</ButtonBase>\n            ) : \"\"}\n            {this.props.authenticated ? (\n              <ButtonBase component={Link} to=\"/info/leaders\" className=\"nav-item\">Leaders</ButtonBase>\n             ) : \"\"} \n            {this.props.authenticated ? (\n              <ButtonBase component={Link} to=\"/search\" className=\"nav-item\">Search</ButtonBase>\n            ) : \"\"} \n            {this.props.authenticated ? (\n              <div className=\"account-button\">\n                <h4 style={{ \"margin\": \"0 0.5em\", \"padding\": \"0 0.5em\" }}>Score: {this.state.score}</h4>\n                <AccountButton logout={this.logout} />\n              </div>\n            ) : (\n              <div className=\"account-button\">\n                <LoginForm />\n              </div>\n            )}\n          </div>\n        </Toolbar>\n      </AppBar>\n    );\n  }\n}\n\nexport default withRouter(Header);","import React, { Component } from 'react';\n\nclass AudioVisualiser extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = React.createRef();\n  }\n\n  componentDidUpdate() {\n    this.draw();\n  }\n\n  draw() {\n    const { audioData } = this.props;\n    const canvas = this.canvas.current;\n    const height = canvas.height;\n    const width = canvas.width;\n    const context = canvas.getContext('2d');\n    let x = 0;\n    const sliceWidth = (width * 1.0) / audioData.length;\n\n    context.lineWidth = 1;  // stroke width\n    context.strokeStyle = \"#000000\";  // stroke color\n    context.clearRect(0, 0, width, height);\n    context.beginPath();\n    context.moveTo(0, height / 2);\n\n    for (const item of audioData) {\n      const y = item / 255.0 * height;\n      context.lineTo(x, y);\n      x += sliceWidth;\n    }\n\n    context.lineTo(x, height / 2);\n    context.stroke();\n  }\n\n  render() {\n    return <canvas width=\"300\" height=\"300\" ref={this.canvas} className=\"audio-canvas\" />;\n  }\n}\n\nexport default AudioVisualiser;","import React, { Component } from \"react\";\nimport { Grid, IconButton } from \"@material-ui/core\";\nimport PlayArrow from \"@material-ui/icons/PlayArrow\";\nimport Pause from \"@material-ui/icons/Pause\";\nimport AudioVisualizer from \"./AudioVisualizer\";\nimport firebase from \"../base\";\nimport staticFirebase from \"firebase/app\";\n\nclass AudioAnalyser extends Component {\n  constructor(props) {\n    \n    super(props);\n    this._isMounted = false;\n    this.state = {\n      audioData: new Uint8Array(0),\n      play: false,\n      url: '',\n    };\n    this.tick = this.tick.bind(this);\n  \n  }\n\n  setupAudioContext = () => {\n    // set up audioContext\n    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n    this.gainNode = this.audioContext.createGain();\n    this.gainNode.gain.value = 15;\n    this.gainNode.connect(this.audioContext.destination);\n\n    // set up audio\n    this.audioSource = this.audioContext.createMediaElementSource(this.audio);\n    this.audioSource.connect(this.gainNode);\n\n    // set up audio analyser\n    this.analyser = this.audioContext.createAnalyser();\n    this.gainNode.connect(this.analyser);\n    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    this.rafId = requestAnimationFrame(this.tick);\n\n    // put 'play' state to false when the sound ends\n    this.audio.onended = () => {\n      if (this._isMounted) {\n        this.setState({ play: false});\n      }\n    }\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.user = firebase.auth().currentUser;\n    this.db = firebase.firestore();\n    this.currentId = firebase.auth().currentUser.uid;\n    this.firstPlay = 0;\n    this.audio = new Audio(this.props.url);\n    this.audio.crossOrigin = \"anonymous\";\n    if(window.screen.height > 420 && window.screen.width > 380){\n      this.toggleAudio();\n    }\n  }\n\n  tick() {\n    this.analyser.getByteTimeDomainData(this.dataArray);\n    if (this._isMounted) {\n      this.setState({ audioData: this.dataArray });\n    }\n    this.rafId = requestAnimationFrame(this.tick);\n  }\n\n  toggleAudio = () => {\n      if (this.firstPlay === 0) {\n        try {\n          this.setupAudioContext();//first time hit play, set up audio context\n          console.log(\"props!\" , this.props.clipId);\n          var d = Date.now();\n          this.db.collection('Randomize').doc(this.props.clipId).set({//this clip has been seen once by this user\n            count:  staticFirebase.firestore.FieldValue.increment(1),\n            updated: staticFirebase.firestore.FieldValue.serverTimestamp(),\n            millis: d,\n            userId: staticFirebase.firestore.FieldValue.arrayUnion(this.currentId)\n          },{merge:true});\n        } catch(err) {\n          console.log(err);\n        }\n    }\n    this.state.play ? this.audio.pause() : this.playAuto(this.audio);\n    if (this._isMounted) {\n      this.setState({ play: !this.state.play });\n    }\n    this.firstPlay ++;\n  };\n\n  playAuto(audio){\n    this.audioContext.resume().then(() => {\n       audio.play();\n    });\n  }\n\n  componentWillUnmount() {\n    cancelAnimationFrame(this.rafId);\n    this.analyser.disconnect();\n    this.gainNode.disconnect();\n    this.audioSource.disconnect();\n    this._isMounted = false;\n  }\n\n  render() {\n    return (\n      <Grid item sm={6} md={6} lg={6} className=\"canvas-container\">\n        <IconButton\n          className=\"play-button\"\n          onClick={this.toggleAudio}\n          disableRipple\n          disableTouchRipple\n        >\n          {this.state.play ? (\n            <Pause style={{ fontSize: \"180px\" }} />\n          ) : (\n            <PlayArrow style={{ fontSize: \"180px\" }} />\n          )}\n        </IconButton>\n        {this.state.play ? (\n          <AudioVisualizer audioData={this.state.audioData} />\n        ) : (\n          <canvas width=\"300\" height=\"300\" className=\"audio-canvas\" />\n        )}\n      </Grid>\n    );\n  }\n}\n\nexport default AudioAnalyser;","import React, { Component } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  Button,\n  ButtonBase\n} from \"@material-ui/core\";\n\n//TODO: Read from DB to check if user is the first time to play game and pop up the game rule if true\nclass GameRuleDialog extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      showExample: false\n    };\n  }\n\n  toggleExample = () => {\n    this.setState({ showExample: !this.state.showExample });\n  }\n\n  handleClickOpen = () => {\n    this.setState({ open: true });\n  };\n\n  handleClose = () => {\n    this.setState({ open: false, showExample: false });\n  }\n\n  render() {\n    return (\n      <div>\n        <Button onClick={this.handleClickOpen}>Rules</Button>\n        <Dialog\n          open={this.state.open}\n          onClose={this.handleClose}\n        >\n          <DialogTitle>Game Rules</DialogTitle>\n          <DialogContent>\n            <ul className=\"rule-list\">\n              <li>You will be presented with one randomly selected 10-second sound clip at a time.</li>\n              <li>Describe that clip with a word or phrase (we call them \"tags\", here are some&nbsp;\n              <ButtonBase\n                onClick={this.toggleExample}\n                style={{ \"fontSize\": \"0.9em\", \"textDecoration\": \"underline\" }}\n              >examples</ButtonBase>\n              ) and <b>press enter</b>.</li>\n              {this.state.showExample ? (\n                <div className=\"example-tags-list\">\n                <ul>\n                  <li>\n                    Animals  bird, songbird, sparrow, white-crowned sparrow,\n                    gambel's white crowned sparrow\n                  </li>\n                  <li>\n                    Human-generated sounds  airplane, helicopter, drilling,\n                    engine, rumbling\n                  </li>\n                  <li>\n                    Weather  wind, rain, thunder, gale, drizzle, dripping,\n                    stream, river\n                  </li>\n                  <li>Scenes  quiet night, dawn chorus</li>\n                  <li>\n                    Time  summer, winter, june, august afternoon, night, dawn\n                  </li>\n                  <li>Feelings  calm, busy, soothing, loud, cacophonous</li>\n                </ul>\n                </div>\n              ) :\"\"}\n              <li>If you're the first person to describe that clip with that tag, you'll get <b>2 points</b> when the next person tags that clip with that tag.</li>\n              <li>If you're the second person to describe that clip with that tag, you'll get <i>1 point</i> immediately.</li>\n              <li>If more than two people have already tagged that clip with that tag, you <span className=\"pink\">won't get any points</span>, but you can try another tag.</li>\n              <li>Tag each clip as many times as you want, follow one of the \"next clip\" links to listen to a new one.</li>\n            </ul>\n          </DialogContent>\n          <p style={{ \"margin\": \"0em 2em 2em\" }}>You can come back to see the rules by clicking \"rules\" at the top-left corner.</p>\n        </Dialog>\n      </div>\n    );\n  }\n}\n\nexport default GameRuleDialog;","import React, { Component } from \"react\";\n      import {\n        Grid,\n        FormControl,\n        Input,\n        InputLabel,\n        InputAdornment,\n        Icon,\n        IconButton,\n        FormHelperText,\n        CircularProgress,\n        Tooltip\n      } from \"@material-ui/core\";\n      import Send from \"@material-ui/icons/Send\";\n      import KeyboardArrowRight from \"@material-ui/icons/KeyboardArrowRight\";\n      import KeyboardArrowLeft from \"@material-ui/icons/KeyboardArrowLeft\";\n      import Help from \"@material-ui/icons/HelpOutline\";\n      import AudioAnalyser from \"./AudioAnalyser\";\n      import firebase from \"../base\";\n      import staticFirebase from \"firebase\";\n      import GameRuleDialog from \"./GameRuleDialog\";\n      import { Link } from \"react-router-dom\";\n     \n      const INITIAL_STATE = {\n        currentTags:{},\n        displayTag:{},\n        loading: true,\n        clipHistory: {},\n        scoredClipHistory: {},\n      };\n      export default class GamePage extends Component {\n        constructor(props) {\n          super(props);\n          this.state = {...INITIAL_STATE};\n          this.textInput = React.createRef();\n        }  \n        componentDidMount = async() =>{\n          this.user = firebase.auth().currentUser;\n          this.db = firebase.firestore();\n          this.currentId = firebase.auth().currentUser.uid;\n          this.userId = this.user.uid;\n          this.userRef = this.db.collection('users').doc(this.currentId);\n          this.audioRef = this.db.collection('audios');\n          this.firstUserId = '';\n          this.loadUrl();\n         //this.loadFiles();\n         // this.Summary();\n        }\n        componentDidUpdate(prevProps, prevState) {\n          this.textInput.current.focus(); \n        }\n        Summary = async () => {\n          var tempTag = [];\n          var tempTag1 = [];\n          const clipHistorySnapshot = await this.userRef.collection('clipHistory').orderBy('lastUpdatedAt').limit(10).get();\n          const clipHistory = {};\n          \n        for (const clip of clipHistorySnapshot.docs){\n            clipHistory[clip.id] = { score: clip.data().score };\n            var audio = this.db.collection('audios').doc(clip.id).get();\n            tempTag = [];\n            tempTag1 = [];\n            var tagsSnapshot = this.db.collection('audios').doc(clip.id).collection('users').doc(this.userId).get();\n            var otherTagSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').get();\n            \n            const [audio1,tagsSnapshot1,otherTagSnapshot1] = await Promise.all([audio,tagsSnapshot,otherTagSnapshot]);\n            clipHistory[clip.id].title = audio1.data().Title;\n            clipHistory[clip.id].url = audio1.data().Url;\n            clipHistory[clip.id].id = clip.id;\n\n            tempTag = tagsSnapshot1.data().tags;\n            clipHistory[clip.id].TAG = tempTag.join(\", \");\n\n            for(const tag of otherTagSnapshot1.docs){\n              if(!tempTag.includes(tag.id)){\n                tempTag1.push(tag.id);\n              }\n            }\n              clipHistory[clip.id].other = tempTag1.join(\", \");\n            this.setState({ clipHistory });\n        }\n      \n          const scoredClipHistorySnapshot = await this.userRef.collection('clipHistory').where(\"score\", \">\", 0).orderBy(\"score\").limit(10).get();\n          const scoredClipHistory = {};\n          for(const clip of scoredClipHistorySnapshot.docs){\n            scoredClipHistory[clip.id] = { score: clip.data().score };\n            var audioSnapshot = this.db.collection('audios').doc(clip.id).get();\n            var scoreTagsSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').where(\"userId\", 'array-contains',this.userId).get();\n            var otherScoreTagSnapshot = this.db.collection('audios').doc(clip.id).collection('tags').get();\n          \n          const [audio1,scoreTagsSnapshot1,otherScoreTagSnapshot1] = await Promise.all([audioSnapshot,scoreTagsSnapshot,otherScoreTagSnapshot]);\n            scoredClipHistory[clip.id].title = audio1.data().Title;\n            scoredClipHistory[clip.id].url = audio1.data().Url;\n            scoredClipHistory[clip.id].id = clip.id;\n            tempTag = [];\n            tempTag1 = [];\n\n            for(const tag of scoreTagsSnapshot1.docs){\n              tempTag.push(tag.id);\n            }\n            scoredClipHistory[clip.id].TAG = tempTag.join(\", \");\n\n            for(const tag of otherScoreTagSnapshot1.docs){\n              if(!tempTag.includes(tag.id)){\n                tempTag1.push(tag.id);\n              }\n            }\n            scoredClipHistory[clip.id].other = tempTag1.join(\", \");\n            this.setState({ scoredClipHistory });\n          }\n          this.props.history.push({\n            pathname: '/main',\n            state: {\n             clipHistory: this.state.clipHistory,\n             scoredClipHistory: this.state.scoredClipHistory\n            }\n          })\n        }\n        handleKeyPress = event => {\n          if (event.key === 'Enter') {\n            document.getElementById(\"submitButton\").click();\n          }\n        }\n        //this function loads JSON file under 'public' directory (which contains each clips Url) into firebase collections\n        loadFiles = async () => {\n          var data;\n          var xmlhttp = new XMLHttpRequest();\n          var myJSON;\n          var items;\n          var dataArray = [];\n          var audiosDataRef = await this.db.collection('audios');\n          var randomRef = await this.db.collection('Randomize');\n          xmlhttp.onreadystatechange = async function(){\n            if(xmlhttp.status === 200 && xmlhttp.readyState === 4){\n              data = xmlhttp.responseText;\n              console.log(typeof(data));\n              myJSON = JSON.parse(data);\n              items = myJSON.items;\n              for(var i = 0; i < items.length; i++){\n               \taudiosDataRef.doc(i+'').set({\n                  Title: items[i].name,\n                  Url: 'https://firebasestorage.googleapis.com/v0/b/majorminer-dd13a.appspot.com/o/'+items[i].name+'?alt=media&token='+items[i].metadata.firebaseStorageDownloadTokens\n                });\n               \trandomRef.doc(i+'').set({\n               \t\tcount: 0\n               \t});\n              }\n            }\n          };\n          xmlhttp.open(\"GET\",\"/text/data.json\",true);\n          xmlhttp.send();\n          console.log(dataArray.length);\n        }\n        //random loading Url\n        loadUrl = async () => {\n          console.log(\"currentUser: \" + firebase.auth().currentUser.uid);\n          this.existingTags = {};\n          this.clipId = await this.randomizeId();\n          console.log(this.clipId);\n         \n          this.audioRef = await this.db.collection('audios').doc(this.clipId);\n          try {\n            // load url\n            const doc = await this.audioRef.get();\n            this.url = doc.data().Url;\n            console.log(this.clipId);\n            console.log(this.url);\n          }catch(err){\n            console.log(err);\n          } \n          await this.setState({ loading: false });\n        }\n        //getting existing tags from database\n        loadExistingTag = tags => {\n          // load existing tags       \n          try{\n            if (tags) {\n            tags.forEach(tag => (this.existingTags[tag.id] = {\n              count: tag.data().count,\n            }));\n           }\n          }catch(err){\n            console.log(\"loadExistingTagError: \" + err);\n          }\n          return this.existingTags;\n        } \n        //compare timeStamps\n        compareTime = async timeStamp => {\n          var month = [];\n          month[0] = \"January\";\n          month[1] = \"February\";\n          month[2] = \"March\";\n          month[3] = \"April\";\n          month[4] = \"May\";\n          month[5] = \"June\";\n          month[6] = \"July\";\n          month[7] = \"August\";\n          month[8] = \"September\";\n          month[9] = \"October\";\n          month[10] = \"November\";\n          month[11] = \"December\";\n         \n          const thatTime = timeStamp.toMillis();    \n          var d = new Date();\n          var todayDate = d.getDate()+'';\n          var thisMonth = month[d.getMonth()]+' ';\n          var year = d.getFullYear()+'';\n          const parseStringToday = thisMonth+todayDate+', '+year;\n          var today = Date.parse(parseStringToday);\n          const now = Date.now();\n          var compare = now - thatTime;\n          \n          if(compare <= 3600000) return 1;\n          else if(thatTime <= today+3600000 * 24) return 2;\n          else if(thatTime <= today+3600000 * 24 * 7) return 3;\n          else return 4;\n        }\n        oneDayRange = () => {\n          var month = [];\n          month[0] = \"January\";\n          month[1] = \"February\";\n          month[2] = \"March\";\n          month[3] = \"April\";\n          month[4] = \"May\";\n          month[5] = \"June\";\n          month[6] = \"July\";\n          month[7] = \"August\";\n          month[8] = \"September\";\n          month[9] = \"October\";\n          month[10] = \"November\";\n          month[11] = \"December\";\n         \n          var d = new Date();\n          var todayDate = d.getDate()+'';\n          var thisMonth = month[d.getMonth()]+' ';\n          var year = d.getFullYear()+'';\n          const parseStringToday = thisMonth+todayDate+', '+year;\n          var today = Date.parse(parseStringToday);//millionSeconds for 00:00:00 today\n          return today+ 3600000 * 24;\n        }\n        randomizeId = async() => {\n          var clip;\n          var userHasSeen = new Set();\n          var rand = Math.random();   \n          var currentUserSeenSnapshot = await this.db.collection('Randomize').where('userId', 'array-contains', this.currentId).get();//current user has seen\n          for(const userSeen of currentUserSeenSnapshot.docs){\n            userHasSeen.add(userSeen.id);\n          }\n          var pnew = this.findMin(0.0066*currentUserSeenSnapshot.size,0.33);\n          console.log(\"rand\", rand);\n          console.log(\"pnew\", pnew);\n          if(rand < pnew){\n            clip = this.pick_pioneer();\n            console.log(\"rand < pnew\");\n          }else{\n            clip = this.pick_settler(userHasSeen);\n            console.log(\"rand > pnew\");\n          }\n          return clip;\n        }\n        pick_pioneer = async() => {\n          var noSeenSnapshot = await this.db.collection('Randomize').where('count', '==', 0).get();\n            if(noSeenSnapshot.size !== 0) {// pick the one has not been seen \n              console.log(\"noSeenSnapshot[0]\");\n              return noSeenSnapshot.docs[0].id+'';\n            }\n          console.log(\"Math.random\");\n          return Math.floor((Math.random()*5))+'';//every clip has been seen\n        }\n        pick_settler = async (userHasSeen) => {\n          var now = Date.now(); //pick the one has been seen && has not been seen in the last hour && current user has no seen\n          var oneHour = now - 3600000;\n          var oneHourNoSeenSnapshot = await this.db.collection('Randomize').where('millis', '<', oneHour).orderBy('millis').get();//no seen past hour \n          if(oneHourNoSeenSnapshot.size === 0){//every clip has been seen in past hour, unlikely occur but still might or there are some clips have no been seen at all\n            console.log(\"oneHourNoSeenSnapshot == 0\");\n            return this.pick_pioneer();\n          }else{//some clips have no been seen in past hour\n            ///////debug console\n            console.log(\"oneHourNoSeenSnapshot:  \",oneHourNoSeenSnapshot);\n            for(const clip of oneHourNoSeenSnapshot.docs){\n              console.log(\"oneHourNoSeenSnapshot\", clip.id);\n            }\n            ///////////\n\n            for(const clip of oneHourNoSeenSnapshot.docs){\n              if(!userHasSeen.has(clip.id)){\n                console.log(\"!userHasSeen.has(clip.id)\");\n                return clip.id+'';\n              }\n            } \n            //this user has seen all of the clips in the oneHourNoSeenSnapshot\n            return this.pick_pioneer();\n          }\n        }\n        findMin = (num1,num2) => {\n           if(num1 > num2)\n              return num2;\n            return num1;\n        }\n\n        //getting next clips\n        getNextClip = async () => {\n          await this.setState({currentTags:{}, loading: true, displayTag:{}});\n          this.loadUrl();\n        }  \n        //submit tags\n        handleSubmit = async () => {\n          const newTags = document.getElementById(\"tags\").value.toLowerCase().replace(/\\s/g,'').split(\",\");\n          //generate temporatyTags set from new Tags\n          var tempCurrentTags = {};\n          this.audioTagRef = await this.audioRef.collection('tags');\n          this.audioUsersRef = await this.audioRef.collection('users');\n          \n          const tags = await this.audioTagRef.get();\n          //generate exitingTags from DB\n          this.existingTags = await this.loadExistingTag(tags);\n  \n          console.log(\"existingTags\");\n          console.log(this.existingTags);\n        \n          newTags.forEach(tag => {\n            if(Object.keys(this.existingTags).includes(tag)){\n              tempCurrentTags[tag] = {\n                count: this.existingTags[tag].count,\n                score: 0,\n              }\n            }else{\n             tempCurrentTags[tag] = {\n                count: 0,\n                score: 0,\n              }\n            }\n          });\n          console.log(\"displayTag\");\n          console.log(this.state.displayTag);\n          document.getElementById(\"tags\").value = \"\";\n          this.loadTagsToDb(tempCurrentTags).then(tempCurrentTags => {\n            //tempCurrentTags = tempCurrentTags;\n            this.setState({currentTags: tempCurrentTags});\n            for( const tag of Object.keys(tempCurrentTags)){\n               this.setState(prevState => ({ displayTag: {...prevState.displayTag, [tag]: {score: tempCurrentTags[tag].score, count:  tempCurrentTags[tag].count }}}));\n            }\n          }) \n        }\n        //get first user Id \n        getUserId = async tag => {\n          var firstUser = await this.db.collection('audios').doc(this.clipId).collection('users').where('tags', 'array-contains', tag).get();\n          console.log(\"firstUser:  \", firstUser.docs[0].id);\n          return firstUser.docs[0].id;\n        }\n        //laoding tags into DB\n        loadTagsToDb = async (currentTags) => {\n          try{\n            for(const tag of Object.keys(currentTags)){ \n              await this.addUser(tag);\n              this.History(this.userRef,this.currentId,0);\n              if (currentTags[tag].count === 1) {\n                //if this user is the second person describe the tag, add 2 points to the first user\n                var firstUserId = await this.getUserId(tag);\n                var firstUserRef = await this.db.collection('users').doc(firstUserId);\n                console.log(\"!!firstUserId: \" + firstUserId);\n                if(firstUserId !== this.currentId){//if the first user is not current user \n                     this.History(firstUserRef,firstUserId,2);\n                    //get 1 point if current user is the second person describe this tag\n                     currentTags[tag].score = 1;\n                     this.History(this.userRef,this.currentId,1);\n                }          \n              } else if(currentTags[tag].count === 0){ //if the user is the first person, 0 score for now, count = 1\n                  this.History(this.userRef,this.currentId,0);\n              }else{//if the user is the third or more than third person, no points\n                this.History(this.userRef,this.currentId,0);\n              }\n              await this.audioUsersRef.doc(this.currentId).set({\n                tags: staticFirebase.firestore.FieldValue.arrayUnion(tag)//add the user to \"users\" collection,save the tags as array\n              },{ merge: true });\n             }\n            }catch(err){\n            console.log(\"can't upload tags into DB!!:  \"+ err);\n          }\n          return currentTags;\n        }\n        addUser = tag => {\n          try{\n            this.audioTagRef.doc(tag).set({\n              count: staticFirebase.firestore.FieldValue.increment(1),\n              userId: staticFirebase.firestore.FieldValue.arrayUnion(this.currentId)\n            },{merge: true});\n          }catch(err){\n            console.log(\"can't add user: \" + err);\n          }\n        }\n        refreshTotalScore = (userRef,score) => {\n          userRef.update({\n            score: staticFirebase.firestore.FieldValue.increment(score)\n          })\n        }\n        isFrist = tag => {\n          this.audioTagRef.doc(tag).set({\n            count: 1,\n            userId: staticFirebase.firestore.FieldValue.arrayUnion(this.currentId)\n          })\n        }\n        History = async (userRef, userId, score) => {\n          try{\n          var userClipHistoryRef = await userRef.collection('clipHistory');\n           userClipHistoryRef.doc(this.clipId).get()\n              .then(doc => {\n                 if (doc.exists) {\n                   this.updateHistory(userClipHistoryRef,score);\n                 } else {\n                   this.createHistory(userClipHistoryRef,score);\n                 }\n                  this.refreshTotalScore(userRef,score);\n              });\n          }catch(err){\n            console.log(\"Can't create clipHistory!! \" + err);\n          }\n          if(score !== 0){//if this user gained scores, save it to the scoreRecord collection\n            var oneDayRangeMillis = this.oneDayRange();\n            try{\n              var scoreRecordRef = this.db.collection('scoreRecord').doc(userId);\n              var scoreRef = await this.db.collection('scoreRecord').doc(userId).collection('score');\n              scoreRef.doc(oneDayRangeMillis+'').get()\n                .then(doc => {\n                  if(doc.exists){\n                    scoreRef.doc(oneDayRangeMillis+'').update({\n                      score: staticFirebase.firestore.FieldValue.increment(score)\n                   });\n                  }else{\n                    scoreRef.doc(oneDayRangeMillis+'').set({\n                      score: score,\n                      millis: oneDayRangeMillis,\n                      createdAt: staticFirebase.firestore.FieldValue.serverTimestamp()\n                    })\n                  }\n                });\n              var username = await this.db.collection('users').doc(userId).get();\n              var user = username.data().username;\n              scoreRecordRef.set({\n                updated: staticFirebase.firestore.FieldValue.serverTimestamp(),\n                millis: oneDayRangeMillis,\n                username: user\n              });\n            }catch(e){\n              console.log(\"Can't add score scoreRecord!\");\n            }\n          }\n        }\n        updateHistory = (userClipHistoryRef,score) => {\n          try{\n            userClipHistoryRef.doc(this.clipId).update({\n              score: staticFirebase.firestore.FieldValue.increment(score),\n              lastUpdatedAt: staticFirebase.firestore.FieldValue.serverTimestamp()\n            });\n          }catch(err){\n            console.log(\"Can't update clipHistory: \" + err);\n          }\n        }\n        createHistory = (userClipHistoryRef,score) => {\n          try{\n            userClipHistoryRef.doc(this.clipId).set({\n              score: staticFirebase.firestore.FieldValue.increment(score),\n              createdAt: staticFirebase.firestore.FieldValue.serverTimestamp(),\n              lastUpdatedAt: staticFirebase.firestore.FieldValue.serverTimestamp()\n            });\n          }catch(err){\n            console.log(\"Can't create clipHistory: \" + err);\n          }\n        }\n        render() {\n         const url = this.url;\n         const clipId = this.clipId;\n         const {displayTag} = this.state;\n          return (\n            <Grid container className=\"game-container\" direction=\"column\" alignItems=\"center\" spacing={16}>\n              <Grid item container alignItems=\"center\">\n                <Grid item sm={1} md={1} lg={1}><GameRuleDialog /></Grid>\n                <Grid item sm={10} md={10} lg={10}>\n                  <h1>Describe this clip</h1>\n                </Grid>\n                <Grid item sm={1} md={1} lg={1}></Grid>\n              </Grid>\n              <Grid item container alignItems=\"center\">\n                <Grid item sm={3} md={3} lg={3}>  \n                  <Link to=\"/main\" style={{ \"textDecoration\": \"none\" }}>     \n                      <IconButton id=\"gameSummary\" style={{ \"borderRadius\": \"0\" }}>\n                        <KeyboardArrowLeft />\n                        Summary\n                      </IconButton>  \n\n                    </Link>    \n                </Grid>\n                {this.state.loading ? (\n                  <Grid item sm={6} md={6} lg={6} className=\"canvas-container\">\n                    <CircularProgress size={100} thickness={3.6} />\n                  </Grid>\n                ) : (\n                  <AudioAnalyser url={url} clipId={clipId}/>\n                )}\n                <Grid item sm={3} md={3} lg={3}>\n                  <IconButton id=\"nextClip\" style={{ \"borderRadius\": \"0\" }} onClick={this.getNextClip}>\n                    Next Clip\n                    <KeyboardArrowRight />\n                  </IconButton>\n                </Grid>\n              </Grid>\n             <Grid item id=\"listTag\" sm={10} md={6} lg={8}>\n                {Object.keys(displayTag).map((tag, i) => {\n                  if (displayTag[tag].count === 0) {\n                    return (<span key={i} className=\"gray\">{tag}&nbsp;</span>)\n                  } else if (displayTag[tag].score === 1) {\n                    return (<i key={i} className=\"1-point\">{tag}&nbsp;</i>)\n                  } else {\n                    return (<span key={i} className=\"pink\">{tag}&nbsp;</span>)\n                   } \n                })}\n              </Grid>\n              <Grid item sm={10} md={6} lg={8}>\n                <FormControl margin=\"normal\" fullWidth>\n                  <InputLabel>Input your tags...</InputLabel>\n                  <Input\n                    id=\"tags\"\n                    type=\"text\"\n                    autoFocus={true}\n                    inputRef={this.textInput}\n                    onKeyPress={this.handleKeyPress}\n                    endAdornment={\n                      <InputAdornment position=\"end\">\n                        <IconButton id=\"submitButton\" onClick={this.handleSubmit}>\n                          <Send />\n                        </IconButton>\n                        <Tooltip\n                          title={\n                            <p>You can input more than one tag <br />by using commas to separate.</p>\n                          }\n                          placement=\"right\"\n                        >\n                          <Icon>\n                            <Help />\n                          </Icon>\n                        </Tooltip>\n                      </InputAdornment>\n                    }\n                  />\n                  <FormHelperText>\n                    Tag colors: <i>1 point</i>, <span className=\"gray\">no points yet (but could be 2)</span>, <span className=\"pink\">0 points</span>.\n                  </FormHelperText>\n                </FormControl>\n              </Grid>\n            </Grid>\n          );\n        }\n      }\n     ","import React, { Component } from \"react\";\nimport {\n  Card,\n  CardContent,\n  CardActions,\n  IconButton\n} from \"@material-ui/core\";\nimport PlayArrow from \"@material-ui/icons/PlayArrow\";\nimport Pause from \"@material-ui/icons/Pause\";\nimport Group from \"@material-ui/icons/Group\";\nimport Person from \"@material-ui/icons/Person\";\n\nclass AudioCard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      play: false,\n      seeOthers: false\n    };\n  }\n\n  componentDidMount() {\n    this.setupAudioContext();\n  }\n  setupAudioContext = () => {\n    try{\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      this.gainNode = this.audioContext.createGain();\n      this.gainNode.gain.value = 15;\n      this.gainNode.connect(this.audioContext.destination);\n    }catch(error){\n      console.log(error);\n    }\n\n    this.audio = new Audio(this.props.url);\n    this.audioSource = this.audioContext.createMediaElementSource(this.audio);\n    this.audio.crossOrigin = \"anonymous\";\n    this.audioSource.connect(this.gainNode);\n    this.audioContext.resume().then(() => {\n      console.log('Playback resumed successfully');\n    })\n    this.audio.onended = () => {\n      this.setState({ play: false });\n      this.props.togglePlay(false);\n    }\n  }\n\n  toggleAudio = () => {\n    if (this.state.play === false) {\n      try {\n        this.setupAudioContext();\n      } catch(err) {\n        console.log(err);\n      }\n    }\n    this.state.play ? this.audio.pause() : this.audio.play();\n    this.setState({ play: !this.state.play });\n    this.props.togglePlay(!this.state.play);\n  }\n\n  toggleSeeOtherTags = () => {\n    this.setState({ seeOthers: !this.state.seeOthers });\n  }\n\n  componentWillUnmount() {\n    this.gainNode.disconnect();\n    this.audioSource.disconnect();\n  }\n  //Audio cards for SummaryPage.js\n  SummaryAudioCard = () => {\n    return(\n      <Card className=\"audio-card\">\n        <CardContent>\n          <h5>{this.props.clip}</h5>\n          <p>Your tags: {this.props.TAG || 'loading'}</p>\n         {this.state.seeOthers ? (\n           <p>Other's tags: {this.props.other || 'None'} </p>) : \"\"}\n        </CardContent>\n        <CardActions style={{ paddingTop: \"0\" }}>\n          <IconButton onClick={this.toggleAudio}>\n            {this.state.play ? (<Pause />) : (<PlayArrow />)}\n          </IconButton>\n          <IconButton onClick={this.toggleSeeOtherTags}>\n            {this.state.seeOthers ? (<Person />) : (<Group />)}\n          </IconButton>\n        </CardActions>\n      </Card>\n    );\n  }\n  //Audio cards for SearchResult.js\n  SearchResultAudioCard = () => {\n    return(\n      <Card className=\"audio-card\">\n      <CardContent>  \n          <h5>{this.props.clip}</h5>\n      </CardContent>\n      <CardActions style={{ paddingTop: \"0\" }}>\n          <IconButton onClick={this.toggleAudio}>\n            {this.state.play ? (<Pause />) : (<PlayArrow />)}\n          </IconButton>\n      </CardActions>\n     <h5>{this.props.tag}: {this.props.count} times</h5>\n    </Card>\n    );\n  }\n  render() {\n    return (\n      <div>\n          {this.props.fromSummary ? this.SummaryAudioCard() : this.SearchResultAudioCard()}     \n      </div>  \n    )\n  }\n}\nexport default AudioCard;","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport {\n  Grid\n} from \"@material-ui/core\";\nimport AudioCard from \"./AudioCard\";\nimport firebase from \"../base\";\n//TODO: load tags from DB\nclass SummaryPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      clipHistory: {},\n      scoredClipHistory: {},\n      play: false\n    }\n  }\n\n  async componentDidMount() {\n    this.user = firebase.auth().currentUser;\n    this.db = firebase.firestore();\n    this.audioRef = this.db.collection('audios');\n    this.userId = this.user.uid;\n    this.userRef = this.db.collection('users').doc(this.userId);\n    //summary\n    var tempTag = [];\n    var tempTag1 = [];\n    const clipHistorySnapshot = await this.userRef.collection('clipHistory').orderBy('lastUpdatedAt').limit(10).get();\n   \n    \n    const clipHistory = {};\n    \n   for (const clip of clipHistorySnapshot.docs){\n      clipHistory[clip.id] = { score: clip.data().score };\n      var audio = this.audioRef.doc(clip.id).get();\n      tempTag = [];\n      tempTag1 = [];\n      var tagsSnapshot = this.audioRef.doc(clip.id).collection('users').doc(this.userId).get();\n      var otherTagSnapshot = this.audioRef.doc(clip.id).collection('tags').get();\n      \n      const [audio1,tagsSnapshot1,otherTagSnapshot1] = await Promise.all([audio,tagsSnapshot,otherTagSnapshot]);\n      clipHistory[clip.id].title = audio1.data().Title;\n      clipHistory[clip.id].url = audio1.data().Url;\n      clipHistory[clip.id].id = clip.id;\n      tempTag = tagsSnapshot1.data().tags;\n      clipHistory[clip.id].TAG = tempTag.join(\", \");\n      for(const tag of otherTagSnapshot1.docs){\n         if(!tempTag.includes(tag.id)){\n          tempTag1.push(tag.id);\n         }\n      }\n        clipHistory[clip.id].other = tempTag1.join(\", \");\n      this.setState({ clipHistory });\n   }\n \n    const scoredClipHistorySnapshot = await this.userRef.collection('clipHistory').where(\"score\", \">\", 0).orderBy(\"score\").limit(10).get();\n    const scoredClipHistory = {};\n    for(const clip of scoredClipHistorySnapshot.docs){\n      scoredClipHistory[clip.id] = { score: clip.data().score };\n      var audioSnapshot = this.audioRef.doc(clip.id).get();\n      var scoreTagsSnapshot = this.audioRef.doc(clip.id).collection('tags').where(\"userId\", 'array-contains',this.userId).get();\n      var otherScoreTagSnapshot = this.audioRef.doc(clip.id).collection('tags').get();\n     \n     const [audio1,scoreTagsSnapshot1,otherScoreTagSnapshot1] = await Promise.all([audioSnapshot,scoreTagsSnapshot,otherScoreTagSnapshot]);\n      scoredClipHistory[clip.id].title = audio1.data().Title;\n      scoredClipHistory[clip.id].url = audio1.data().Url;\n      scoredClipHistory[clip.id].id = clip.id;\n      tempTag = [];\n      tempTag1 = [];\n      for(const tag of scoreTagsSnapshot1.docs){\n        tempTag.push(tag.id);\n      }\n      scoredClipHistory[clip.id].TAG = tempTag.join(\", \");\n      for(const tag of otherScoreTagSnapshot1.docs){\n         if(!tempTag.includes(tag.id)){\n          tempTag1.push(tag.id);\n         }\n      }\n      scoredClipHistory[clip.id].other = tempTag1.join(\", \");\n      this.setState({ scoredClipHistory });\n    }\n    /////\n  }\n  togglePlay = play => {\n    this.setState({ play });\n  }\n\n  render() {\n      //const { clipHistory, scoredClipHistory } = this.props.location.state;\n      const { clipHistory, scoredClipHistory } = this.state;\n    return (\n      <Grid container className=\"summary-container\" direction=\"column\" alignItems=\"center\">\n        <Grid item>\n          <h1>Summary Page</h1>\n        </Grid>\n        <Grid item>\n          <Link to=\"/main/clip\">Play game!</Link>\n        </Grid>\n        <h2>Your last 10 clips</h2>\n        <Grid item className=\"card-list-container\"> \n          <Grid container className=\"card-list\" spacing={8}>\n          {Object.keys(clipHistory).map((clip, i) => (\n            <Grid item key={clip}>\n              <AudioCard\n                url={clipHistory[clip].url}\n                clip={clipHistory[clip].title}\n                clipId={clipHistory[clip].id}\n                TAG={clipHistory[clip].TAG}\n                togglePlay={this.togglePlay}\n                other={clipHistory[clip].other}\n                fromSummary={true}\n              />\n            </Grid>\n          ))}\n          </Grid>\n        </Grid>\n        <h2>Your last scored clips</h2>\n        <Grid item className=\"card-list-container\"> \n          <Grid container className=\"card-list\" spacing={8}>\n          {Object.keys(scoredClipHistory).map((clip, i) =>(\n            <Grid item key={i}>\n              <AudioCard\n                url={scoredClipHistory[clip].url}\n                clip={scoredClipHistory[clip].title}\n                TAG={scoredClipHistory[clip].TAG}\n                clipId={scoredClipHistory[clip].id}\n                other={scoredClipHistory[clip].other}\n                togglePlay={this.togglePlay}\n                fromSummary={true}\n              />\n            </Grid>\n          ))}\n          </Grid>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default SummaryPage;","import React, { Component } from \"react\";\nimport {\n  AppBar,\n  Tabs,\n  Tab,\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell\n} from \"@material-ui/core\";\n// import app from \"../base\";\nimport app from \"../base\";\n\nclass LeadersPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: 0,\n      todayLeader: [],\n      weekLeader: [],\n      totalLeader: []\n    };\n  }\n  componentDidMount(){\n    this.user = app.auth().currentUser;\n    this.db = app.firestore();\n     if(this.user){\n      this.currentId = app.auth().currentUser.uid;\n    }\n    this.getTotal();\n    this.getToday();\n    this.getWeek();\n  }\n  month = () => {\n     var month = [];\n      month[0] = \"January\";\n      month[1] = \"February\";\n      month[2] = \"March\";\n      month[3] = \"April\";\n      month[4] = \"May\";\n      month[5] = \"June\";\n      month[6] = \"July\";\n      month[7] = \"August\";\n      month[8] = \"September\";\n      month[9] = \"October\";\n      month[10] = \"November\";\n      month[11] = \"December\";\n      return month;\n  }\n  handleChange = (event, value) => {\n    this.setState({ value });\n  };\n  oneDayRange = () => {\n    var monthArray = this.month();\n    var d = new Date();\n    var todayDate = d.getDate()+'';\n    var month = monthArray[d.getMonth()]+' ';\n    var year = d.getFullYear()+'';\n    const parseStringToday = month+todayDate+', '+year;\n    var today = Date.parse(parseStringToday);//millionSeconds for 00:00:00 today\n    console.log(\"today: \", today);\n    return today+ 3600000 * 24;\n  }\n  firstOfWeekRange = () => {\n    var monthArray = this.month();\n    var d = new Date();\n    var first = d.getDay();\n    var todayDate = d.getDate()+'';\n    var month = monthArray[d.getMonth()]+' ';\n    var year = d.getFullYear()+'';\n    const parseStringToday = month+todayDate+', '+year;\n    var today = Date.parse(parseStringToday);\n    console.log(\"first day of the week\", first);\n\n    var firstOfWeek = today - (first-1)*3600000*24; //Database collection saved a day after current day's millionseconds\n    return firstOfWeek;\n  }\n  //get Total Leaders\n  getTotal = async () => {\n    const totalLeader = [];\n    const userSnapshot = await this.db.collection('users').where(\"score\", \">\", 0).get();\n    for(const doc of userSnapshot.docs){\n      let set = {username: doc.data().username, score: doc.data().score, userId: doc.id};\n        totalLeader.push(set);\n    } \n    totalLeader.sort((a,b) => {\n      return b.score-a.score;\n    })\n    totalLeader.splice(10,totalLeader.length);//only display first 10th user\n    await this.setState({totalLeader: totalLeader});\n      console.log(this.state.totalLeader);\n  };\n  //get Today's leaders\n  getToday = async () => {\n    const todayLeader = [];\n    var todayRange = this.oneDayRange();\n    var todayUserSnapshot = await this.db.collection('scoreRecord').where('millis', '==', todayRange).get();\n    for(const user of todayUserSnapshot.docs){\n      var score = await this.db.collection('scoreRecord').doc(user.id).collection('score').where('millis','==',todayRange).get();\n      let set = {username: user.data().username, score: score.docs[0].data().score, userId: user.id};\n      todayLeader.push(set);\n    }\n    todayLeader.sort((a,b) => {\n      return b.score-a.score;\n    })\n    todayLeader.splice(10,todayLeader.length);\n    await this.setState({todayLeader: todayLeader});\n    console.log(\"today: \", new Date(todayRange));\n    console.log(\"today!!!leader: \", todayLeader);\n  }\n  //get this week's leaders\n  getWeek = async () => {\n    const weekLeader = [];\n    var thisWeekRange = this.firstOfWeekRange();\n    console.log(\"thisWeekRange:  \", thisWeekRange);\n    console.log(\"Sunday\", new Date(thisWeekRange));\n    var weekUserSnapshot = await this.db.collection('scoreRecord').where('millis', '>=', thisWeekRange).get();\n    for(const user of weekUserSnapshot.docs){\n      var totalScore=0;\n      var scoreSnapshot = await this.db.collection('scoreRecord').doc(user.id).collection('score').where('millis', '>=', thisWeekRange).get();\n      for(const score of scoreSnapshot.docs){\n        totalScore += score.data().score;\n      }\n      let set = {username: user.data().username, score: totalScore, userId: user.id};\n      weekLeader.push(set);\n    }\n    weekLeader.sort((a,b) => {\n      return b.score-a.score;\n    })\n    weekLeader.splice(10,weekLeader.length);\n    await this.setState({weekLeader: weekLeader});\n    console.log(\"weekLeader: \", weekLeader);\n  }\n  getTabContent = (todayLeader, weekLeader, totalLeader) => {\n     \n      let content;\n      switch(this.state.value){\n        case 0: \n          content = todayLeader;//this.todayTable();\n          break;\n        case 1:\n          content = weekLeader;//this.weekTable();\n          break;\n        case 2:\n          content = totalLeader;//this.totalTable();\n          break;\n        default:\n          content = [];\n    }\n    return (\n      <Table className=\"leaderboard\">\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\">User</TableCell>\n            <TableCell align=\"center\">Score</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {content.map((user,i) => (\n            <TableRow key={user.userId}>\n              <TableCell align=\"center\" >{user.username}</TableCell>\n              <TableCell align=\"center\">{user.score}</TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    );\n  }\n\n  render() {\n    const {todayLeader,weekLeader,totalLeader} = this.state;\n    return (\n      <div>\n        <h1>Leaders</h1>\n        <div className=\"table-container\">\n          <AppBar position=\"static\">\n            <Tabs\n              value={this.state.value}\n              onChange={this.handleChange}\n              centered\n            >\n              <Tab label=\"Today\" />\n              <Tab label=\"This week\" />\n              <Tab label=\"Total\" />\n            </Tabs>\n          </AppBar>\n          {this.getTabContent(todayLeader,weekLeader,totalLeader)}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default LeadersPage;","import React, { Component } from \"react\";\nimport {\n  Grid,\n  Button\n} from \"@material-ui/core\";\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport firebase from \"../base\";\n\nclass SearchPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {  \n      topTags: []\n    };\n  }\n  async componentDidMount(){\n     this.user = firebase.auth().currentUser;\n     this.db = firebase.firestore();\n     this.currentId = firebase.auth().currentUser.uid;\n     this.userRef = this.db.collection('users');\n     this.setState({\n       topTags: await this.getTagList()\n     })\n  }\n   getTagList = async () => {\n      var tagList = [];\n      const myPromise = await this.db.collection('tagList').orderBy(\"count\",\"desc\").limit(10).get();\n      for(const p of myPromise.docs)\n         tagList.push({tag: p.id, count: p.data().count});\n     return tagList;\n  }\n  handleKeyPress = event => {\n    if (event.key === 'Enter') {\n      document.getElementById(\"searchButton\").click();\n    }\n  }\n  handleSubmit = () => {\n     var searchItem = document.getElementById(\"searchItem\").value;\n     this.handleListClick(null,searchItem);\n  }\n  //when each tag has been clicked..\n  handleListClick = async (event,tag) => {\n    // const tagPromise = await this.db.collection('tagList').doc(tag).collection('clipIDs').get();\n    // const tagOrder = await this.db.collection('tagList').doc(tag).collection('clipIDs').orderBy('count','desc').get();\n    // var tagOrderArray = [];\n    // for(const p of tagOrder.docs)\n    //    tagOrderArray.push({tag: p.id, count: p.data().count});\n  \n    // this.MyTagMap = {};\n    // for(const p of tagPromise.docs){\n    //     this.MyTagMap[p.id] = {};\n    //     const tagObject = await this.db.collection('tagList').doc(tag).collection('clipIDs').doc(p.id).get();\n    //     this.MyTagMap[p.id].url = tagObject.data().Url;\n    //     this.MyTagMap[p.id].clip = tagObject.data().Title;\n    //     this.MyTagMap[p.id].count = tagObject.data().count;\n    // }\n    // this.props.history.push({\n    //   pathname: '/searchresult',\n    //   state: {\n    //     tag: tag,\n    //     MyTag: this.MyTagMap,\n    //     tagOrderArray: tagOrderArray,\n    //     clipNumber: tagPromise.size\n    //   }\n    // })\n    this.props.history.push({\n        pathname: '/searchresult/'+ tag\n    })\n\n  }\n  getList = (topTags) =>{\n    return(\n      <List>\n        {topTags.map( (item,tag) =>(\n          <ListItem button = {true} key={item.tag}>\n            <ListItemText primary= {item.tag} onClick = {event => this.handleListClick(event, item.tag)}/>\n          </ListItem>\n        ))}\n      </List>\n    );\n  }\n  render() {\n    const{topTags} = this.state;\n    return (\n    \t <Grid container\n          className=\"search-container\"\n          direction=\"column\"\n          alignItems=\"center\">\n        \t <Grid item>\n          \t\t<h1>Search Page</h1>\n           </Grid>  \n          <Grid item >\n              <label>Search by tag: </label>\n              <input\n                id=\"searchItem\"\n                type=\"text\"  \n                onKeyPress={this.handleKeyPress}/>             \n                <Button id=\"searchButton\" onClick={this.handleSubmit}>search</Button>\n          </Grid>\n         <Grid item xs={12} md={6}>              \n              <div >\n                 {this.getList(topTags)}                \n              </div>\n          </Grid>\n      </Grid>\n    )\n  }\n}\n\nexport default SearchPage;","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport {\n  Grid\n} from \"@material-ui/core\";\nimport AudioCard from \"../main/AudioCard\";\nimport firebase from \"../base\";\n\nclass SearchResult extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tag: null,\n      MyTag: null,\n      tagOrderArray: [],\n      clipNumber: null,\n      play: false\n    }\n  }\n  async componentDidMount() {\n    this.user = firebase.auth().currentUser;\n    this.db = firebase.firestore();\n    this.audioRef = this.db.collection('audios');\n    this.userId = this.user.uid;\n    this.userRef = this.db.collection('users').doc(this.userId);\n    this.getCurrentTarget();\n  //   //summary\n  //   var tempTag = [];\n  //   var tempTag1 = [];\n  //   const clipHistorySnapshot = await this.userRef.collection('clipHistory').orderBy('lastUpdatedAt').limit(10).get();\n   \n    \n  //   const clipHistory = {};\n    \n  //  for (const clip of clipHistorySnapshot.docs){\n  //     clipHistory[clip.id] = { score: clip.data().score };\n  //      var audio = this.audioRef.doc(clip.id).get();\n  //     tempTag = [];\n  //     tempTag1 = [];\n  //     var tagsSnapshot = this.audioRef.doc(clip.id).collection('users').doc(this.userId).get();\n  //     var otherTagSnapshot = this.audioRef.doc(clip.id).collection('tags').get();\n      \n  //     const [audio1,tagsSnapshot1,otherTagSnapshot1] = await Promise.all([audio,tagsSnapshot,otherTagSnapshot]);\n  //     clipHistory[clip.id].title = audio1.data().Title;\n  //     clipHistory[clip.id].url = audio1.data().Url;\n  //     clipHistory[clip.id].id = clip.id;\n  //     tempTag = tagsSnapshot1.data().tags;\n  //     clipHistory[clip.id].TAG = tempTag.join(\", \");\n  //     for(const tag of otherTagSnapshot1.docs){\n  //        if(!tempTag.includes(tag.id)){\n  //         tempTag1.push(tag.id);\n  //        }\n  //     }\n  //       clipHistory[clip.id].other = tempTag1.join(\", \");\n  //     this.setState({ clipHistory });\n  //  }\n \n  //   const scoredClipHistorySnapshot = await this.userRef.collection('clipHistory').where(\"score\", \">\", 0).orderBy(\"score\").limit(10).get();\n  //   const scoredClipHistory = {};\n  //   for(const clip of scoredClipHistorySnapshot.docs){\n  //     scoredClipHistory[clip.id] = { score: clip.data().score };\n  //     var audioSnapshot = this.audioRef.doc(clip.id).get();\n  //     var scoreTagsSnapshot = this.audioRef.doc(clip.id).collection('tags').where(\"userId\", 'array-contains',this.userId).get();\n  //     var otherScoreTagSnapshot = this.audioRef.doc(clip.id).collection('tags').get();\n     \n  //    const [audio1,scoreTagsSnapshot1,otherScoreTagSnapshot1] = await Promise.all([audioSnapshot,scoreTagsSnapshot,otherScoreTagSnapshot]);\n  //     scoredClipHistory[clip.id].title = audio1.data().Title;\n  //     scoredClipHistory[clip.id].url = audio1.data().Url;\n  //     scoredClipHistory[clip.id].id = clip.id;\n  //     tempTag = [];\n  //     tempTag1 = [];\n  //     for(const tag of scoreTagsSnapshot1.docs){\n  //       tempTag.push(tag.id);\n  //     }\n  //     scoredClipHistory[clip.id].TAG = tempTag.join(\", \");\n  //     for(const tag of otherScoreTagSnapshot1.docs){\n  //        if(!tempTag.includes(tag.id)){\n  //         tempTag1.push(tag.id);\n  //        }\n  //     }\n  //     scoredClipHistory[clip.id].other = tempTag1.join(\", \");\n  //     this.setState({ scoredClipHistory });\n  //   }\n  }\n  async getCurrentTarget(){\n      console.log(window.location.href)\n      var url = window.location.href;\n      let index = url.lastIndexOf('/');\n      console.log(index);\n      let tag = url.substring(index+1,url.length);\n      console.log(\"target is: \", tag);\n\n\n      const tagPromise = await this.db.collection('tagList').doc(tag).collection('clipIDs').get();\n      const tagOrder = await this.db.collection('tagList').doc(tag).collection('clipIDs').orderBy('count','desc').get();\n      var tagOrderArray = [];\n      for(const p of tagOrder.docs)\n        tagOrderArray.push({tag: p.id, count: p.data().count});\n    \n      this.MyTagMap = {};\n      for(const p of tagPromise.docs){\n          this.MyTagMap[p.id] = {};\n          const tagObject = await this.db.collection('tagList').doc(tag).collection('clipIDs').doc(p.id).get();\n          this.MyTagMap[p.id].url = tagObject.data().Url;\n          this.MyTagMap[p.id].clip = tagObject.data().Title;\n          this.MyTagMap[p.id].count = tagObject.data().count;\n      }\n\n      await this.setState({\n        tag: tag,\n        MyTag: this.MyTagMap,\n        tagOrderArray: tagOrderArray,\n        clipNumber: tagPromise.size\n      });\n      // this.props.history.push({\n      //   pathname: '/searchresult',\n      //   state: {\n      //     tag: tag,\n      //     MyTag: this.MyTagMap,\n      //     tagOrderArray: tagOrderArray,\n      //     clipNumber: tagPromise.size\n      //   }\n      // })\n  }\n  togglePlay = play => {\n    this.setState({ play });\n  }\n  render() {\n    //const {MyTag,tag,clipNumber,tagOrderArray} = this.props.location.state\n    const {MyTag,tag,clipNumber,tagOrderArray} = this.state\n    return (\n      <Grid container className=\"summary-container\" direction=\"column\" alignItems=\"center\">\n        <Grid item>\n          <h1>Search Result</h1>\n        </Grid>\n        <Grid item>\n          <Link to=\"/search\">Search more!</Link>\n        </Grid>\n        <Grid item>\n          <Link to=\"/main/clip\">Play game!</Link>\n        </Grid>\n    <h2>Here are {clipNumber} clips have been describe as {tag}</h2>\n        <Grid item className=\"card-list-container\"> \n          <Grid container className=\"card-list\" spacing={8}>\n          {tagOrderArray.map((clip, i) => (\n            <Grid item key={clip.tag}>\n              <AudioCard\n                tag={tag}\n                clip={MyTag[clip.tag].clip}\n                url={MyTag[clip.tag].url}\n                count={MyTag[clip.tag].count}\n                togglePlay={this.togglePlay}\n                fromSummary={false}\n              />\n            </Grid>\n          ))}\n          </Grid>\n        </Grid>     \n      </Grid>\n    );\n  }\n}\n\nexport default SearchResult;","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport { BrowserRouter as Router, Route, Redirect,Switch} from \"react-router-dom\";\nimport firebase from \"./base\";\nimport {\n  MuiThemeProvider,\n  createMuiTheme,\n  CircularProgress\n} from \"@material-ui/core\";\nimport LandingPage from \"./landing/LandingPage\";\nimport Footer from \"./root/Footer\";\nimport FaqPage from \"./info/FaqPage\";\nimport ContactPage from \"./info/ContactPage\";\nimport PrivacyPage from \"./info/PrivacyPage\";\nimport Header from \"./root/Header\";\nimport NewGamePage from \"./main/NewGamePage\";\nimport SummaryPage from \"./main/SummaryPage\";\nimport LeadersPage from \"./info/LeadersPage\";\nimport SearchPage from \"./search/SearchPage\";\nimport SearchResult from \"./search/SearchResult\";\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: \"#C6C6CE\"\n    },\n    secondary: {\n      main: \"#A6A6B2\"\n    }\n  },\n  typography: {\n    useNextVariants: true\n  }\n});\n\nfunction PrivateRoute({ component: Component, authenticated, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        authenticated === true ? (\n          <Component {...props} {...rest} />\n        ) : (\n          <Redirect to=\"/\" />\n        )\n      }\n    />\n  );\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      authenticated: false,\n      user: null,\n      loading: true\n    };\n  }\n\n  componentDidMount() {\n    this.listener = firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        this.setState({\n          authenticated: true,\n          user: user,\n          loading: false\n        });\n      } else {\n        this.setState({\n          authenticated: false,\n          user: null,\n          loading: false\n        });\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    this.listener();\n  }\n\n  toggleAuth = auth => {\n    this.setState({ authenticated: auth });\n  };\n\n  render() {\n    if (this.state.loading) {\n      return (\n        <MuiThemeProvider theme={theme}>\n          <div className=\"loading-container\">\n            <CircularProgress size={100} thickness={3.6} />\n          </div>\n        </MuiThemeProvider>\n      );\n    }\n    return (\n      <MuiThemeProvider theme={theme} >\n        <Router> \n          <div className=\"App\">\n            <Header\n              authenticated={this.state.authenticated}\n              toggleAuth={this.toggleAuth}\n            />\n            <main>\n            <Switch>\n              <Route\n                exact\n                path=\"/\"\n                render={props => (\n                  <LandingPage\n                    {...props}\n                    authenticated={this.state.authenticated}\n                  />\n                )}\n              />\n              <Route path=\"/info/faq\" component={FaqPage} />\n              <Route path=\"/info/contact\" component={ContactPage} />\n              <Route path=\"/info/privacy\" component={PrivacyPage} />\n              <Route path=\"/info/leaders\" component={LeadersPage} />\n              <Route path=\"/searchresult\" component={SearchResult} />\n              <PrivateRoute\n                exact\n                path=\"/main\"\n                component={SummaryPage}\n                authenticated={this.state.authenticated}\n              />\n              <PrivateRoute\n                exact\n                path=\"/main/clip\"\n                component={NewGamePage}\n                authenticated={this.state.authenticated}\n              />\n              <PrivateRoute\n                path=\"/search\"\n                component={SearchPage}\n                authenticated={this.state.authenticated}\n              />\n              </Switch>\n            </main>\n            <Footer />\n          </div>\n        </Router>\n      </MuiThemeProvider>\n    );\n  }\n}\n\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}